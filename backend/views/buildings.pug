extends layout.pug

block content
  - var currentYear = (new Date()).getFullYear()
  - var url
  .row 
    .col-3
      .border
        .p-3
          p View buildings in a specific year
          form.d-flex(action='/buildings/existingInYear', method='get')
            input.form-control.me-sm-2(type='number', name='query', placeholder='Year', max=currentYear)
            button.btn.btn-secondary.my-2.my-sm-0(type='submit') 
              i.fas.fa-search
          hr
          p View buildings built between 
          form.d-flex(action='/buildings/builtBetween', method='get')
            input.form-control.me-sm-2(type='number', required, name='startYear', placeholder='Start', max=currentYear)
            input.form-control.me-sm-2(type='number', required, name='endYear', placeholder='End', max=currentYear)
            button.btn.btn-secondary.my-2.my-sm-0(type='submit') 
              i.fas.fa-search
          hr
          p View buildings destroyed between
          form.d-flex(action='/buildings/destroyedBetween', method='get')
            input.form-control.me-sm-2(type='number', required, name='startYear', placeholder='Start', max=currentYear)
            input.form-control.me-sm-2(type='number', required, name='endYear', placeholder='End', max=currentYear)
            button.btn.btn-secondary.my-2.my-sm-0(type='submit') 
              i.fas.fa-search
          hr
          - url = "/buildings/existingInYear?query=" + currentYear
          a(href=url) Only show currently standing

          if message 
            hr
            a(href="/buildings") Clear filters

    .col-9
      if message 
        h4 #{message}
      else if secondQuery
        h4 Viewing buildings standing in #{secondQuery}
      else 
        h4 Viewing all buildings
      table.table.table-hover
        thead
          tr
            th(scope='col')
              a.nav-link.dropdown-toggle(data-bs-toggle='dropdown' href='#' role='button' aria-haspopup='true' aria-expanded='false') Name
              .dropdown-menu
                - url = previousFilter ? "/buildings/sortedByName/a-z/" + previousFilter : "/buildings/sortedByName/a-z/"
                a.dropdown-item(href=url) A-Z
                - url = previousFilter ? "/buildings/sortedByName/z-a/" + previousFilter : "/buildings/sortedByName/z-a/"
                a.dropdown-item(href=url) Z-A
            th(scope='col') 
              a.nav-link.dropdown-toggle(data-bs-toggle='dropdown' href='#' role='button' aria-haspopup='true' aria-expanded='false') Year Built
              .dropdown-menu
                - url = previousFilter ? "/buildings/sortedByYearBuilt/most-recent/" + previousFilter : "/buildings/sortedByYearBuilt/most-recent/"
                a.dropdown-item(href=url) Most Recent
                - url = previousFilter ? "/buildings/sortedByYearBuilt/oldest/" + previousFilter : "/buildings/sortedByYearBuilt/oldest/"
                a.dropdown-item(href=url) Oldest
            th(scope='col') 
              a.nav-link.dropdown-toggle(data-bs-toggle='dropdown' href='#' role='button' aria-haspopup='true' aria-expanded='false') Year Destroyed
              .dropdown-menu
                - url = previousFilter ? "/buildings/sortedByYearDestroyed/most-recent/" + previousFilter : "/buildings/sortedByYearDestroyed/most-recent/"
                a.dropdown-item(href=url) Most Recent
                - url = previousFilter ? "/buildings/sortedByYearDestroyed/oldest/" + previousFilter : "/buildings/sortedByYearDestroyed/most-recent/"
                a.dropdown-item(href=url) Oldest
            th(scope='col') Address
            th(scope='col') Address Description
        each building in buildings 
          - var url = '/profile/' + building.name
          tr.table-secondary
            th(scope='row') 
              a(href=url) #{building.name}
            td #{building.year_built}
            td #{building.year_destroyed}
            td #{building.address}
            td #{building.address_description}
            //- td.d-flex.justify-content-center
            //-   img(src=building.url alt='Trulli' max-width='100%' height='80')